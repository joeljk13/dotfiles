# This is designed to be a common script for bash and zsh to run on
# initialization

alias sx=startx

alias g=git
alias v='f -e vim -b viminfo'
alias no='yes n'

alias ls='ls --color=auto'
alias ll='ls -lh --color=auto'
alias la='ls -lAh --color=auto'
alias l='ls -lh --color=auto'

alias "cd~"='cd ~'
alias "cd.."='cd ..'
alias "cd..."='cd ../..'
alias "cd...."='cd ../../..'
alias "cd....."='cd ../../../..'

if [ -n "$(alias grep 2>/dev/null)" ]; then
    alias grep='grep --color=auto'
fi

_SHELLRC_TMPDIR="$(mktemp -d)"
alias shred='shred -z'
rm()
{
    local arg dashdash=false files
    declare -a files
    for arg; do
        case "$(sed <<< "$arg" "s|^$HOME||")" in
            (/*)
                echo "Refusing to remove $arg" >&2
                return 1
                ;;
            (--)
                ! $dashdash && dashdash=true || files+="--"
                ;;
            (-*)
                $dashdash && files+="$arg"
                ;;
            (*)
                files+="$arg"
                ;;
        esac
    done
    mkdir -p "$_SHELLRC_TMPDIR"
    sync
    if [ "$(du --total -- $files | tail -1 | awk '{print $1}')" -gt "$(df \
        --output=avail "$_SHELLRC_TMPDIR" | awk 'NR == 2')" ]; then
        echo "Refusing to remove - too big" >&2
        return 1
    fi
    cp "$@" "$_SHELLRC_TMPDIR" && env rm "$@"
}

alias "jk:wq"="echo You\'re not in vim."
alias ":wq"="echo You\'re not in vim."
alias "jk:w"="echo You\'re not in vim."
alias ":w"="echo You\'re not in vim."
alias "jk:q"="echo You\'re not in vim."
alias ":q"="echo You\'re not in vim."

alias sp='systemctl suspend'
alias hsp='systemctl hybrid-sleep'
alias xsp='xlock& sleep 2; systemctl suspend'
alias xhsp='xlock& sleep 2; systemctl hybrid-sleep'

alias fuck='eval "$(thefuck "$(fc -ln -1 | tail -n 1)")"; fc -R'
alias FUCK=fuck

if hash fasd 2>/dev/null; then
    eval "$(fasd --init auto)"
fi

if ! ps -u "$USER" | awk '{print $NF}' | grep -q '\(^\|/\)ssh-agent$'; then
    eval "$(ssh-agent -s)"
    ssh-add
fi

# vim:set ft=sh:
